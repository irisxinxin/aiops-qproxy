
[Unit]
Description=AIOps Q Proxy Runner (v2.4 merged-final)
After=network.target

[Service]
Type=simple
# 核心配置
Environment=Q_BIN=/usr/local/bin/q
Environment=QWORKDIR=/home/ubuntu/huixin/aiops/aiops-qproxy-v2.4
Environment=QCTX_DIR=/home/ubuntu/huixin/aiops/aiops-qproxy-v2.4/ctx/final
Environment=QLOG_DIR=/home/ubuntu/huixin/aiops/aiops-qproxy-v2.4/logs
Environment=QDATA_DIR=/home/ubuntu/huixin/aiops/aiops-qproxy-v2.4/data

# SOP 配置
Environment=Q_SOP_DIR=/home/ubuntu/huixin/aiops/aiops-qproxy-v2.4/ctx/sop
Environment=Q_SOP_PREPEND=1
Environment=Q_FALLBACK_CTX=/home/ubuntu/huixin/aiops/aiops-qproxy-v2.4/aiops-fallback-sop/fallback_ctx/fallback_ctx.jsonl

# 输出控制
Environment=NO_COLOR=1
Environment=CLICOLOR=0
Environment=TERM=dumb

WorkingDirectory=/home/ubuntu/huixin/aiops/aiops-qproxy-v2.4
ExecStart=/home/ubuntu/huixin/aiops/aiops-qproxy-v2.4/bin/qproxy-runner
Restart=always
RestartSec=2
User=ubuntu
Group=ubuntu

[Install]
WantedBy=multi-user.target
